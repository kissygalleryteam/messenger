<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>messenger的demo</title>
    <script src="http://g.tbcdn.cn/kissy/k/1.3.0/kissy-min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="http://g.tbcdn.cn/kissy/k/1.3.0/css/dpl/base-min.css">
</head>
<body>
<h2>messenger的demo</h2>
		<input type="text" value="" id="content" /> <button type="button" id="btn">向 iframe 发送消息</button>
		<script>
			var S = KISSY;
			var srcPath = "../../../";
			S.Config.debug = true;
			S.config({
				packages:[
					{
						name:"gallery",
						path:srcPath,
						charset:"utf-8",
						ignorePackageNameInUri:true
					}
				]
			});

			S.use('core', function(S) {

				S.use('gallery/messenger/1.0/index', function(S, M) {

					var iframe = M.createIframe( { src: 'iframe.html', style: 'width:300px;height:100px'});

					M.register('iframe', function(data) {
						alert('receive message frome iframe: ' + data.toString());	
					});

					S.Event.on('#btn', 'click', function(ev) {
						M.send('parent', S.DOM.get('#content').value, iframe);	
					});
					
				});

			});
		</script>
</body>
</html>
